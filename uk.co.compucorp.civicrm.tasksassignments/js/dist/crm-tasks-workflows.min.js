!function(e,t){"use strict";e.module("crm-tasks-workflows.constants",[]).constant("customFieldIds",t.vars.customFieldIds)}(angular,CRM),function(e){"use strict";angular.module("crm-tasks-workflows.controllers",[])}(),function(e){"use strict";angular.module("crm-tasks-workflows.core",["crmCaseType"])}(),function(e){"use strict";angular.module("crm-tasks-workflows.decorators",[])}(),function(e){"use strict";function t(e,t,o,s,a,r,i,c,n){t.debug("Controller: CaseTypeExtendedController");var l,u,p,d,f,m={};function y(e,t){m.addActivity(e,t),e.activityTypes.forEach(function(e){e.name===t&&delete e.reference_activity})}a.actTypes={values:(l=r.values.map(function(e){return e.label=e.label+" (Task)",e}),u=i.values.map(function(e){return e.label=e.label+" (Document)",e}),l.concat(u))},e("CaseTypeCtrl",{$scope:o,crmApi:s,apiCalls:a}),m.addActivity=o.addActivity,o.addActivity=y,o.defaultRelationshipTypeOptions=(p=a.relTypes.values.filter(function(e){return"1"===e.is_active}),d=[],p.forEach(function(e){var t=e.label_a_b===e.label_b_a;d.push({label:e.label_b_a,value:e.id+"_b_a"}),t||d.push({label:e.label_a_b,value:e.id+"_a_b"})}),d),!o.caseType.id&&(f="custom_"+c["caseType.category"],o.caseType[f]=n,o.caseType.definition.activitySets[0].activityTypes=[])}angular.module("crm-tasks-workflows.controllers").controller("CaseTypeExtendedController",t),t.$inject=["$controller","$log","$scope","crmApi","apiCalls","activityOptionsTask","activityOptionsDocument","customFieldIds","defaultCaseTypeCategory"]}(),function(e){"use strict";function t(e){var t,o;function s(t){return["crmApi",function(e){return e("OptionValue","get",{option_group_id:"activity_type",component_id:t,sequential:1,options:{sort:"name",limit:0}})}]}return t=e.routes["/caseType/:id"],o=e.routes["/caseType"],t.controller="CaseTypeExtendedController",t.resolve.activityOptionsTask=s("CiviTask"),t.resolve.activityOptionsDocument=s("CiviDocument"),t.resolve.defaultCaseTypeCategory=["crmApi",function(e){return e("OptionValue","get",{sequential:1,option_group_id:"case_type_category",is_default:1,options:{limit:1}}).then(function(e){var t=e.values[0]||{};return t.value})}],o.resolve.caseTypes=["crmApi","customFieldIds",function(e,t){var o="custom_"+t["caseType.category"],s={options:{limit:0}};return s[o]="Workflow",e("CaseType","get",s)}],e}angular.module("crm-tasks-workflows.decorators").config(["$provide",function(e){e.decorator("$route",t)}]),t.$inject=["$delegate"]}(),function(e){"use strict";angular.module("crm-tasks-workflows",["crm-tasks-workflows.core","crm-tasks-workflows.constants","crm-tasks-workflows.controllers","crm-tasks-workflows.decorators"])}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNybS10YXNrcy13b3JrZmxvd3MuY29uc3RhbnRzLmpzIiwiY3JtLXRhc2tzLXdvcmtmbG93cy5jb250cm9sbGVycy5qcyIsImNybS10YXNrcy13b3JrZmxvd3MuY29yZS5qcyIsImNybS10YXNrcy13b3JrZmxvd3MuZGVjb3JhdG9yLmpzIiwiY2FzZXR5cGUuZXh0ZW5kZWQuY29udHJvbGxlci5qcyIsInJvdXRlLmRlY29yYXRvci5qcyIsImNybS10YXNrcy13b3JrZmxvd3MuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIkNSTSIsIm1vZHVsZSIsImNvbnN0YW50IiwidmFycyIsImN1c3RvbUZpZWxkSWRzIiwiQ2FzZVR5cGVFeHRlbmRlZENvbnRyb2xsZXIiLCIkY29udHJvbGxlciIsIiRsb2ciLCIkc2NvcGUiLCJjcm1BcGkiLCJhcGlDYWxscyIsImFjdGl2aXR5T3B0aW9uc1Rhc2siLCJhY3Rpdml0eU9wdGlvbnNEb2N1bWVudCIsImRlZmF1bHRDYXNlVHlwZUNhdGVnb3J5IiwiZGVidWciLCJ0YXNrT3B0aW9ucyIsImRvY3VtZW50T3B0aW9ucyIsImFjdGl2ZVJlbGF0aW9uc2hpcFR5cGVzIiwiZGVmYXVsdFJlbGF0aW9uc2hpcFR5cGVPcHRpb25zIiwiY2F0ZWdvcnlGaWVsZG5hbWUiLCJwYXJlbnRNZXRob2RzIiwiYWRkQWN0aXZpdHkiLCJhY3Rpdml0eVNldCIsImFjdGl2aXR5VHlwZSIsImFjdGl2aXR5VHlwZXMiLCJmb3JFYWNoIiwiYWN0aXZpdHkiLCJuYW1lIiwicmVmZXJlbmNlX2FjdGl2aXR5IiwiYWN0VHlwZXMiLCJ2YWx1ZXMiLCJtYXAiLCJ0eXBlIiwibGFiZWwiLCJkb2N1bWVudCIsImNvbmNhdCIsInJlbFR5cGVzIiwiZmlsdGVyIiwicmVsYXRpb25zaGlwVHlwZSIsImlzX2FjdGl2ZSIsImlzQmlkaXJlY3Rpb25hbFJlbGF0aW9uc2hpcCIsImxhYmVsX2FfYiIsImxhYmVsX2JfYSIsInB1c2giLCJ2YWx1ZSIsImlkIiwiY2FzZVR5cGUiLCJkZWZpbml0aW9uIiwiYWN0aXZpdHlTZXRzIiwiY29udHJvbGxlciIsIiRpbmplY3QiLCJSb3V0ZURlY29yYXRvciIsIiRkZWxlZ2F0ZSIsImNhc2VUeXBlRWRpdFJvdXRlIiwiY2FzZVR5cGVMaXN0Um91dGUiLCJnZXRSZXNvbHZlckZvckFjdGl2aXR5VHlwZUNvbXBvbmVudCIsImNvbXBvbmVudE5hbWUiLCJvcHRpb25fZ3JvdXBfaWQiLCJjb21wb25lbnRfaWQiLCJzZXF1ZW50aWFsIiwib3B0aW9ucyIsInNvcnQiLCJsaW1pdCIsInJvdXRlcyIsInJlc29sdmUiLCJpc19kZWZhdWx0IiwidGhlbiIsImRlZmF1bHRDYXNlVHlwZUNhdGVnb3J5UmVzcG9uc2UiLCJjYXNlVHlwZXMiLCJjYXNlVHlwZUNhdGVnb3J5RmllbGQiLCJmaWx0ZXJzIiwiY29uZmlnIiwiJHByb3ZpZGUiLCJkZWNvcmF0b3IiXSwibWFwcGluZ3MiOiJDQUVBLFNBQUFBLEVBQUFDLEdBQ0EsYUFFQUQsRUFBQUUsT0FBQSxnQ0FBQSxJQUNBQyxTQUFBLGlCQUFBRixFQUFBRyxLQUFBQyxnQkFKQSxDQUtBTCxRQUFBQyxLQ0xBLFNBQUFELEdBQ0EsYUFHQUEsUUFEQUUsT0FBQSxrQ0FBQSxJQUhBLEdDQUEsU0FBQUYsR0FDQSxhQUtBQSxRQUhBRSxPQUFBLDJCQUFBLENBQ0EsZ0JBSkEsR0NBQSxTQUFBRixHQUNBLGFBR0FBLFFBREFFLE9BQUEsaUNBQUEsSUFIQSxHQ0FBLFNBQUFGLEdBQ0EsYUFVQSxTQUFBTSxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUNBUixFQUFBUyxHQUNBTixFQUFBTyxNQUFBLDBDQUVBLElBa0dBQyxFQU1BQyxFQXJEQUMsRUFDQUMsRUFrRUFDLEVBdEhBQyxFQUFBLEdBd0JBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0FILEVBQUFDLFlBQUFDLEVBQUFDLEdBR0FELEVBQUFFLGNBQUFDLFFBQUEsU0FBQUMsR0FDQUEsRUFBQUMsT0FBQUosVUFDQUcsRUFBQUUscUJBMERBbEIsRUFBQW1CLFNBQUEsQ0FBQUMsUUFVQWYsRUFBQUosRUFBQW1CLE9BQUFDLElBQUEsU0FBQUMsR0FHQSxPQUZBQSxFQUFBQyxNQUFBRCxFQUFBQyxNQUFBLFVBRUFELElBR0FoQixFQUFBSixFQUFBa0IsT0FBQUMsSUFBQSxTQUFBRyxHQUdBLE9BRkFBLEVBQUFELE1BQUFDLEVBQUFELE1BQUEsY0FFQUMsSUFHQW5CLEVBQUFvQixPQUFBbkIsS0FyQkFWLEVBQUEsZUFBQSxDQUFBRSxPQUFBQSxFQUFBQyxPQUFBQSxFQUFBQyxTQUFBQSxJQWxGQVUsRUFBQUMsWUFBQWIsRUFBQWEsWUFDQWIsRUFBQWEsWUFBQUEsRUFDQWIsRUFBQVUsZ0NBMENBRCxFQTRCQVAsRUFBQTBCLFNBQUFOLE9BQUFPLE9BQUEsU0FBQUMsR0FDQSxNQUFBLE1BQUFBLEVBQUFDLFlBNUJBckIsRUFBQSxHQUVBRCxFQUFBUSxRQUFBLFNBQUFhLEdBQ0EsSUFBQUUsRUFBQUYsRUFBQUcsWUFBQUgsRUFBQUksVUFFQXhCLEVBQUF5QixLQUFBLENBQ0FWLE1BQUFLLEVBQUFJLFVBQ0FFLE1BQUFOLEVBQUFPLEdBQUEsU0FHQUwsR0FDQXRCLEVBQUF5QixLQUFBLENBQ0FWLE1BQUFLLEVBQUFHLFVBQ0FHLE1BQUFOLEVBQUFPLEdBQUEsV0FLQTNCLElBNURBVixFQUFBc0MsU0FBQUQsS0E0R0ExQixFQUFBLFVBQUFmLEVBQUEscUJBRUFJLEVBQUFzQyxTQUFBM0IsR0FBQU4sRUFqRkFMLEVBQUFzQyxTQUFBQyxXQUFBQyxhQUFBLEdBQUF4QixjQUFBLElBb0ZBekIsUUF2SUFFLE9BQUEsbUNBQ0FnRCxXQUFBLDZCQUFBNUMsR0FFQUEsRUFBQTZDLFFBQUEsQ0FDQSxjQUFBLE9BQUEsU0FBQSxTQUFBLFdBQUEsc0JBQUEsMEJBQ0EsaUJBQUEsMkJBUkEsR0NBQSxTQUFBbkQsR0FDQSxhQVNBLFNBQUFvRCxFQUFBQyxHQUNBLElBQ0FDLEVBQ0FDLEVBZ0JBLFNBQUFDLEVBQUFDLEdBQ0EsTUFBQSxDQUFBLFNBQUEsU0FBQS9DLEdBQ0EsT0FBQUEsRUFBQSxjQUFBLE1BQUEsQ0FDQWdELGdCQUFBLGdCQUNBQyxhQUFBRixFQUNBRyxXQUFBLEVBQ0FDLFFBQUEsQ0FBQUMsS0FBQSxPQUFBQyxNQUFBLE9BOENBLE9BckVBVCxFQUFBRCxFQUFBVyxPQUFBLGlCQUNBVCxFQUFBRixFQUFBVyxPQUFBLGFBRUFWLEVBQUFKLFdBQUEsNkJBQ0FJLEVBQUFXLFFBQUFyRCxvQkFBQTRDLEVBQUEsWUFDQUYsRUFBQVcsUUFBQXBELHdCQUFBMkMsRUFBQSxnQkFDQUYsRUFBQVcsUUFBQW5ELHdCQWdEQSxDQUFBLFNBQUEsU0FBQUosR0FDQSxPQUFBQSxFQUFBLGNBQUEsTUFBQSxDQUNBa0QsV0FBQSxFQUNBRixnQkFBQSxxQkFDQVEsV0FBQSxFQUNBTCxRQUFBLENBQUFFLE1BQUEsS0FFQUksS0FBQSxTQUFBQyxHQUNBLElBQUF0RCxFQUFBc0QsRUFBQXJDLE9BQUEsSUFBQSxHQUVBLE9BQUFqQixFQUFBK0IsVUF4REFVLEVBQUFVLFFBQUFJLFVBNkJBLENBQUEsU0FBQSxpQkFBQSxTQUFBM0QsRUFBQUwsR0FDQSxJQUFBaUUsRUFBQSxVQUFBakUsRUFBQSxxQkFDQWtFLEVBQUEsQ0FBQVYsUUFBQSxDQUFBRSxNQUFBLElBR0EsT0FGQVEsRUFBQUQsR0FBQSxXQUVBNUQsRUFBQSxXQUFBLE1BQUE2RCxLQTJCQWxCLEVBRUFyRCxRQWhGQUUsT0FBQSxrQ0FDQXNFLE9BQUEsQ0FBQSxXQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLFVBQUEsU0FBQXRCLE1BR0FBLEVBQUFELFFBQUEsQ0FBQSxhQVJBLEdDQUEsU0FBQW5ELEdBQ0EsYUFRQUEsUUFOQUUsT0FBQSxzQkFBQSxDQUNBLDJCQUNBLGdDQUNBLGtDQUNBLG1DQVBBIiwiZmlsZSI6ImNybS10YXNrcy13b3JrZmxvd3MubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogZ2xvYmFsIGFuZ3VsYXIgKi9cblxuKGZ1bmN0aW9uIChhbmd1bGFyLCBDUk0pIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdjcm0tdGFza3Mtd29ya2Zsb3dzLmNvbnN0YW50cycsIFtdKVxuICAgIC5jb25zdGFudCgnY3VzdG9tRmllbGRJZHMnLCBDUk0udmFycy5jdXN0b21GaWVsZElkcyk7XG59KShhbmd1bGFyLCBDUk0pO1xuIiwiLyogZ2xvYmFsIGFuZ3VsYXIgKi9cblxuKGZ1bmN0aW9uIChhbmd1bGFyKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnY3JtLXRhc2tzLXdvcmtmbG93cy5jb250cm9sbGVycycsIFtdKTtcbn0pKGFuZ3VsYXIpO1xuIiwiLyogZ2xvYmFsIGFuZ3VsYXIgKi9cblxuKGZ1bmN0aW9uIChhbmd1bGFyKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnY3JtLXRhc2tzLXdvcmtmbG93cy5jb3JlJywgW1xuICAgICdjcm1DYXNlVHlwZSdcbiAgXSk7XG59KShhbmd1bGFyKTtcbiIsIi8qIGdsb2JhbCBhbmd1bGFyICovXG5cbihmdW5jdGlvbiAoYW5ndWxhcikge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2NybS10YXNrcy13b3JrZmxvd3MuZGVjb3JhdG9ycycsIFtdKTtcbn0pKGFuZ3VsYXIpO1xuIiwiLyogZ2xvYmFsIGFuZ3VsYXIgKi9cblxuKGZ1bmN0aW9uIChhbmd1bGFyKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnY3JtLXRhc2tzLXdvcmtmbG93cy5jb250cm9sbGVycycpXG4gICAgLmNvbnRyb2xsZXIoJ0Nhc2VUeXBlRXh0ZW5kZWRDb250cm9sbGVyJywgQ2FzZVR5cGVFeHRlbmRlZENvbnRyb2xsZXIpO1xuXG4gIENhc2VUeXBlRXh0ZW5kZWRDb250cm9sbGVyLiRpbmplY3QgPSBbXG4gICAgJyRjb250cm9sbGVyJywgJyRsb2cnLCAnJHNjb3BlJywgJ2NybUFwaScsICdhcGlDYWxscycsICdhY3Rpdml0eU9wdGlvbnNUYXNrJywgJ2FjdGl2aXR5T3B0aW9uc0RvY3VtZW50JyxcbiAgICAnY3VzdG9tRmllbGRJZHMnLCAnZGVmYXVsdENhc2VUeXBlQ2F0ZWdvcnknXG4gIF07XG5cbiAgZnVuY3Rpb24gQ2FzZVR5cGVFeHRlbmRlZENvbnRyb2xsZXIgKCRjb250cm9sbGVyLCAkbG9nLCAkc2NvcGUsIGNybUFwaSwgYXBpQ2FsbHMsIGFjdGl2aXR5T3B0aW9uc1Rhc2ssIGFjdGl2aXR5T3B0aW9uc0RvY3VtZW50LFxuICAgIGN1c3RvbUZpZWxkSWRzLCBkZWZhdWx0Q2FzZVR5cGVDYXRlZ29yeSkge1xuICAgICRsb2cuZGVidWcoJ0NvbnRyb2xsZXI6IENhc2VUeXBlRXh0ZW5kZWRDb250cm9sbGVyJyk7XG5cbiAgICB2YXIgcGFyZW50TWV0aG9kcyA9IHt9O1xuXG4gICAgKGZ1bmN0aW9uIGluaXQgKCkge1xuICAgICAgdmFyIGlzTmV3Q2FzZVR5cGU7XG5cbiAgICAgIGluaXRQYXJlbnRDb250cm9sbGVyKCk7XG5cbiAgICAgIHBhcmVudE1ldGhvZHMuYWRkQWN0aXZpdHkgPSAkc2NvcGUuYWRkQWN0aXZpdHk7XG4gICAgICAkc2NvcGUuYWRkQWN0aXZpdHkgPSBhZGRBY3Rpdml0eTtcbiAgICAgICRzY29wZS5kZWZhdWx0UmVsYXRpb25zaGlwVHlwZU9wdGlvbnMgPSBnZXREZWZhdWx0UmVsYXRpb25zaGlwVHlwZU9wdGlvbnMoKTtcbiAgICAgIGlzTmV3Q2FzZVR5cGUgPSAhJHNjb3BlLmNhc2VUeXBlLmlkO1xuXG4gICAgICBpZiAoaXNOZXdDYXNlVHlwZSkge1xuICAgICAgICBzZXRDYXNlVHlwZURlZmF1bHRDYXRlZ29yeSgpO1xuICAgICAgICBjbGVhckFsbEFjdGl2aXR5VHlwZXNGcm9tTWFpbkFjdGl2aXR5U2V0KCk7XG4gICAgICB9XG4gICAgfSkoKTtcblxuICAgIC8qKlxuICAgICAqIEFkZCBuZXcgYWN0aXZpdHlcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFjdGl2aXR5U2V0XG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGFjdGl2aXR5VHlwZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFkZEFjdGl2aXR5IChhY3Rpdml0eVNldCwgYWN0aXZpdHlUeXBlKSB7XG4gICAgICBwYXJlbnRNZXRob2RzLmFkZEFjdGl2aXR5KGFjdGl2aXR5U2V0LCBhY3Rpdml0eVR5cGUpO1xuXG4gICAgICAvLyByZW1vdmUgcmVmZXJlbmNlX2FjdGl2aXR5IHByb3BlcnR5IGZyb20gbmV3bHkgYWRkZWQgYWN0aXZpdHlcbiAgICAgIGFjdGl2aXR5U2V0LmFjdGl2aXR5VHlwZXMuZm9yRWFjaChmdW5jdGlvbiAoYWN0aXZpdHkpIHtcbiAgICAgICAgaWYgKGFjdGl2aXR5Lm5hbWUgPT09IGFjdGl2aXR5VHlwZSkge1xuICAgICAgICAgIGRlbGV0ZSBhY3Rpdml0eS5yZWZlcmVuY2VfYWN0aXZpdHk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFycyBhbGwgdGhlIGFjdGl2aXR5IHR5cGVzIGRlZmluZWQgaW4gdGhlIG1haW4gYWN0aXZpdHkgc2V0LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNsZWFyQWxsQWN0aXZpdHlUeXBlc0Zyb21NYWluQWN0aXZpdHlTZXQgKCkge1xuICAgICAgJHNjb3BlLmNhc2VUeXBlLmRlZmluaXRpb24uYWN0aXZpdHlTZXRzWzBdLmFjdGl2aXR5VHlwZXMgPSBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBkZWZhdWx0IHJlbGF0aW9uc2hpcCB0eXBlIG9wdGlvbnMuIElmIHRoZSByZWxhdGlvbnNoaXAgaXNcbiAgICAgKiBiaWRpcmVjdGlvbmFsIChFeDogU3BvdXNlIG9mKSBpdCBhZGRzIGEgc2luZ2xlIG9wdGlvbiBvdGhlcndpc2UgaXQgYWRkc1xuICAgICAqIHR3byBvcHRpb25zIHJlcHJlc2VudGluZyB0aGUgcmVsYXRpb25zaGlwIHR5cGUgZGlyZWN0aW9uc1xuICAgICAqIChFeDogRW1wbG95ZWUgb2YsIEVtcGxveWVyIGlzKVxuICAgICAqXG4gICAgICogQHJldHVybiB7QXJyYXl9XG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0RGVmYXVsdFJlbGF0aW9uc2hpcFR5cGVPcHRpb25zICgpIHtcbiAgICAgIHZhciBhY3RpdmVSZWxhdGlvbnNoaXBUeXBlcyA9IGdldEFjdGl2ZVJlbGF0aW9uc2hpcFR5cGVzKCk7XG4gICAgICB2YXIgZGVmYXVsdFJlbGF0aW9uc2hpcFR5cGVPcHRpb25zID0gW107XG5cbiAgICAgIGFjdGl2ZVJlbGF0aW9uc2hpcFR5cGVzLmZvckVhY2goZnVuY3Rpb24gKHJlbGF0aW9uc2hpcFR5cGUpIHtcbiAgICAgICAgdmFyIGlzQmlkaXJlY3Rpb25hbFJlbGF0aW9uc2hpcCA9IHJlbGF0aW9uc2hpcFR5cGUubGFiZWxfYV9iID09PSByZWxhdGlvbnNoaXBUeXBlLmxhYmVsX2JfYTtcblxuICAgICAgICBkZWZhdWx0UmVsYXRpb25zaGlwVHlwZU9wdGlvbnMucHVzaCh7XG4gICAgICAgICAgbGFiZWw6IHJlbGF0aW9uc2hpcFR5cGUubGFiZWxfYl9hLFxuICAgICAgICAgIHZhbHVlOiByZWxhdGlvbnNoaXBUeXBlLmlkICsgJ19iX2EnXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghaXNCaWRpcmVjdGlvbmFsUmVsYXRpb25zaGlwKSB7XG4gICAgICAgICAgZGVmYXVsdFJlbGF0aW9uc2hpcFR5cGVPcHRpb25zLnB1c2goe1xuICAgICAgICAgICAgbGFiZWw6IHJlbGF0aW9uc2hpcFR5cGUubGFiZWxfYV9iLFxuICAgICAgICAgICAgdmFsdWU6IHJlbGF0aW9uc2hpcFR5cGUuaWQgKyAnX2FfYidcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBkZWZhdWx0UmVsYXRpb25zaGlwVHlwZU9wdGlvbnM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIGxpc3Qgb2YgYWN0aXZlIHJlbGF0aW9uc2hpcCB0eXBlcy5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge0FycmF5fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldEFjdGl2ZVJlbGF0aW9uc2hpcFR5cGVzICgpIHtcbiAgICAgIHJldHVybiBhcGlDYWxscy5yZWxUeXBlcy52YWx1ZXMuZmlsdGVyKGZ1bmN0aW9uIChyZWxhdGlvbnNoaXBUeXBlKSB7XG4gICAgICAgIHJldHVybiByZWxhdGlvbnNoaXBUeXBlLmlzX2FjdGl2ZSA9PT0gJzEnO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGlzZSB0aGUgcGFyZW50IGNvbnRyb2xsZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpbml0UGFyZW50Q29udHJvbGxlciAoKSB7XG4gICAgICBhcGlDYWxscy5hY3RUeXBlcyA9IHsgdmFsdWVzOiBwcmVwYXJlQWN0aXZpdHlUeXBlcygpIH07XG4gICAgICAkY29udHJvbGxlcignQ2FzZVR5cGVDdHJsJywgeyRzY29wZTogJHNjb3BlLCBjcm1BcGk6IGNybUFwaSwgYXBpQ2FsbHM6IGFwaUNhbGxzfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IGxpc3Qgb2YgYWN0aXZpdHkgdHlwZXMgd2l0aCBjb21wb25lbnQgdHlwZSBhZGRlZCB0byBsYWJlbFxuICAgICAqXG4gICAgICogQHJldHVybiB7QXJyYXl9XG4gICAgICovXG4gICAgZnVuY3Rpb24gcHJlcGFyZUFjdGl2aXR5VHlwZXMgKCkge1xuICAgICAgdmFyIHRhc2tPcHRpb25zID0gYWN0aXZpdHlPcHRpb25zVGFzay52YWx1ZXMubWFwKGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHR5cGUubGFiZWwgPSAodHlwZS5sYWJlbCArICcgKFRhc2spJyk7XG5cbiAgICAgICAgcmV0dXJuIHR5cGU7XG4gICAgICB9KTtcblxuICAgICAgdmFyIGRvY3VtZW50T3B0aW9ucyA9IGFjdGl2aXR5T3B0aW9uc0RvY3VtZW50LnZhbHVlcy5tYXAoZnVuY3Rpb24gKGRvY3VtZW50KSB7XG4gICAgICAgIGRvY3VtZW50LmxhYmVsID0gKGRvY3VtZW50LmxhYmVsICsgJyAoRG9jdW1lbnQpJyk7XG5cbiAgICAgICAgcmV0dXJuIGRvY3VtZW50O1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB0YXNrT3B0aW9ucy5jb25jYXQoZG9jdW1lbnRPcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBkZWZhdWx0IGNhdGVnb3J5IGZvciB0aGUgY2FzZSB0eXBlLiBUaGUgZGVmYXVsdCBjYXNlIHR5cGUgY2F0ZWdvcnlcbiAgICAgKiBpcyB0aGUgb25lIHNlbGVjdGVkIGFzIGRlZmF1bHQgb24gdGhlIEFQSS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzZXRDYXNlVHlwZURlZmF1bHRDYXRlZ29yeSAoKSB7XG4gICAgICB2YXIgY2F0ZWdvcnlGaWVsZG5hbWUgPSAnY3VzdG9tXycgKyBjdXN0b21GaWVsZElkc1snY2FzZVR5cGUuY2F0ZWdvcnknXTtcblxuICAgICAgJHNjb3BlLmNhc2VUeXBlW2NhdGVnb3J5RmllbGRuYW1lXSA9IGRlZmF1bHRDYXNlVHlwZUNhdGVnb3J5O1xuICAgIH1cbiAgfVxufSkoYW5ndWxhcik7XG4iLCIvKiBnbG9iYWwgYW5ndWxhciAqL1xuXG4oZnVuY3Rpb24gKGFuZ3VsYXIpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdjcm0tdGFza3Mtd29ya2Zsb3dzLmRlY29yYXRvcnMnKVxuICAgIC5jb25maWcoWyckcHJvdmlkZScsIGZ1bmN0aW9uICgkcHJvdmlkZSkge1xuICAgICAgJHByb3ZpZGUuZGVjb3JhdG9yKCckcm91dGUnLCBSb3V0ZURlY29yYXRvcik7XG4gICAgfV0pO1xuXG4gIFJvdXRlRGVjb3JhdG9yLiRpbmplY3QgPSBbJyRkZWxlZ2F0ZSddO1xuXG4gIGZ1bmN0aW9uIFJvdXRlRGVjb3JhdG9yICgkZGVsZWdhdGUpIHtcbiAgICAoZnVuY3Rpb24gaW5pdCAoKSB7XG4gICAgICB2YXIgY2FzZVR5cGVFZGl0Um91dGUgPSAkZGVsZWdhdGUucm91dGVzWycvY2FzZVR5cGUvOmlkJ107XG4gICAgICB2YXIgY2FzZVR5cGVMaXN0Um91dGUgPSAkZGVsZWdhdGUucm91dGVzWycvY2FzZVR5cGUnXTtcblxuICAgICAgY2FzZVR5cGVFZGl0Um91dGUuY29udHJvbGxlciA9ICdDYXNlVHlwZUV4dGVuZGVkQ29udHJvbGxlcic7XG4gICAgICBjYXNlVHlwZUVkaXRSb3V0ZS5yZXNvbHZlLmFjdGl2aXR5T3B0aW9uc1Rhc2sgPSBnZXRSZXNvbHZlckZvckFjdGl2aXR5VHlwZUNvbXBvbmVudCgnQ2l2aVRhc2snKTtcbiAgICAgIGNhc2VUeXBlRWRpdFJvdXRlLnJlc29sdmUuYWN0aXZpdHlPcHRpb25zRG9jdW1lbnQgPSBnZXRSZXNvbHZlckZvckFjdGl2aXR5VHlwZUNvbXBvbmVudCgnQ2l2aURvY3VtZW50Jyk7XG4gICAgICBjYXNlVHlwZUVkaXRSb3V0ZS5yZXNvbHZlLmRlZmF1bHRDYXNlVHlwZUNhdGVnb3J5ID0gZ2V0UmVzb2x2ZXJGb3JEZWZhdWx0Q2FzZVR5cGVDYXRlZ29yeSgpO1xuXG4gICAgICBjYXNlVHlwZUxpc3RSb3V0ZS5yZXNvbHZlLmNhc2VUeXBlcyA9IGdldFJlc29sdmVyRm9yV29ya2Zsb3dUeXBlcygpO1xuICAgIH0pKCk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcmVzb2x2ZXIgZm9yIHRoZSBsaXN0IG9mIGFjdGl2aXR5IHR5cGVzIGZvciBhIHBhcnRpY3VsYXIgY29tcG9uZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7U3RyaW5nfSBjb21wb25lbnROYW1lIC0gdGhlIG5hbWUgb2YgdGhlIGFjdGl2aXR5IHR5cGUncyBjb21wb25lbnQuXG4gICAgICogQHJldHVybiB7QXJyYXl9ICBBbiBhcnJheSBjb250YWluaW5nIHRoZSBmdW5jdGlvbiB0aGF0IHdpbGwgcmVzb2x2ZSB0aGUgYWN0aXZpdHkgdHlwZXMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UmVzb2x2ZXJGb3JBY3Rpdml0eVR5cGVDb21wb25lbnQgKGNvbXBvbmVudE5hbWUpIHtcbiAgICAgIHJldHVybiBbJ2NybUFwaScsIGZ1bmN0aW9uIGFjdGl2aXR5T3B0aW9uc1Jlc29sdmVyIChjcm1BcGkpIHtcbiAgICAgICAgcmV0dXJuIGNybUFwaSgnT3B0aW9uVmFsdWUnLCAnZ2V0Jywge1xuICAgICAgICAgIG9wdGlvbl9ncm91cF9pZDogJ2FjdGl2aXR5X3R5cGUnLFxuICAgICAgICAgIGNvbXBvbmVudF9pZDogY29tcG9uZW50TmFtZSxcbiAgICAgICAgICBzZXF1ZW50aWFsOiAxLFxuICAgICAgICAgIG9wdGlvbnM6IHsgc29ydDogJ25hbWUnLCBsaW1pdDogMCB9XG4gICAgICAgIH0pO1xuICAgICAgfV07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHJlc29sdmVyIGZvciB0aGUgbGlzdCBvZiB3b3JrZmxvdyBjYXNlIHR5cGVzLlxuICAgICAqIFRvIGZpbHRlciBieSBjYXRlZ29yeSB3ZSBuZWVkIHRvIHVzZSB0aGUgY3VzdG9tIGNhdGVnb3J5IGZpZWxkIGlkIGFzXG4gICAgICogcHJvdmlkZWQgYnkgdGhlIENSTSB2YXJzLiBUaGUgY2F0ZWdvcnkgZmllbGQgY2FuIGJlIHJlZmVyZW5jZWQgYnkgdXNpbmdcbiAgICAgKiBgY3VzdG9tXzEyM2Agd2hlcmUgYDEyM2AgaXMgdGhlIGlkIG9mIHRoZSBjYXRlZ29yeSBmaWVsZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSBjb250YWluaW5nIHRoZSBmdW5jdGlvbiB0aGF0IHdpbGwgcmVzb2x2ZSB0aGUgd29ya2Zsb3cgY2FzZSB0eXBlcy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRSZXNvbHZlckZvcldvcmtmbG93VHlwZXMgKCkge1xuICAgICAgcmV0dXJuIFsnY3JtQXBpJywgJ2N1c3RvbUZpZWxkSWRzJywgZnVuY3Rpb24gd29ya2Zsb3dUeXBlc1Jlc29sdmVyIChjcm1BcGksIGN1c3RvbUZpZWxkSWRzKSB7XG4gICAgICAgIHZhciBjYXNlVHlwZUNhdGVnb3J5RmllbGQgPSAnY3VzdG9tXycgKyBjdXN0b21GaWVsZElkc1snY2FzZVR5cGUuY2F0ZWdvcnknXTtcbiAgICAgICAgdmFyIGZpbHRlcnMgPSB7IG9wdGlvbnM6IHsgbGltaXQ6IDAgfSB9O1xuICAgICAgICBmaWx0ZXJzWyBjYXNlVHlwZUNhdGVnb3J5RmllbGQgXSA9ICdXb3JrZmxvdyc7XG5cbiAgICAgICAgcmV0dXJuIGNybUFwaSgnQ2FzZVR5cGUnLCAnZ2V0JywgZmlsdGVycyk7XG4gICAgICB9XTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcmVzb2x2ZXIgZm9yIHRoZSBkZWZhdWx0IGNhc2UgdHlwZSBjYXRlZ29yeS4gVGhlIGRlZmF1bHQgY2F0ZWdvcnlcbiAgICAgKiBpcyB0aGUgb25lIHNlbGVjdGVkIGFzIHN1Y2ggb24gdGhlIEFQSS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSBjb250YWluaW5nIHRoZSBkZXBlbmRlbmNpZXMgYW5kIGZ1bmN0aW9uIHRoYXQgd2lsbFxuICAgICAqIHJlc29sdmUgdGhlIGRlZmF1bHQgY2FzZSB0eXBlIGNhdGVnb3J5IHZhbHVlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFJlc29sdmVyRm9yRGVmYXVsdENhc2VUeXBlQ2F0ZWdvcnkgKCkge1xuICAgICAgcmV0dXJuIFsnY3JtQXBpJywgZnVuY3Rpb24gZGVmYXVsdENhc2VUeXBlQ2F0ZWdvcnlSZXNvbHZlciAoY3JtQXBpKSB7XG4gICAgICAgIHJldHVybiBjcm1BcGkoJ09wdGlvblZhbHVlJywgJ2dldCcsIHtcbiAgICAgICAgICBzZXF1ZW50aWFsOiAxLFxuICAgICAgICAgIG9wdGlvbl9ncm91cF9pZDogJ2Nhc2VfdHlwZV9jYXRlZ29yeScsXG4gICAgICAgICAgaXNfZGVmYXVsdDogMSxcbiAgICAgICAgICBvcHRpb25zOiB7IGxpbWl0OiAxIH1cbiAgICAgICAgfSlcbiAgICAgICAgICAudGhlbihmdW5jdGlvbiAoZGVmYXVsdENhc2VUeXBlQ2F0ZWdvcnlSZXNwb25zZSkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRDYXNlVHlwZUNhdGVnb3J5ID0gZGVmYXVsdENhc2VUeXBlQ2F0ZWdvcnlSZXNwb25zZS52YWx1ZXNbMF0gfHwge307XG5cbiAgICAgICAgICAgIHJldHVybiBkZWZhdWx0Q2FzZVR5cGVDYXRlZ29yeS52YWx1ZTtcbiAgICAgICAgICB9KTtcbiAgICAgIH1dO1xuICAgIH1cblxuICAgIHJldHVybiAkZGVsZWdhdGU7XG4gIH1cbn0pKGFuZ3VsYXIpO1xuIiwiLyogZ2xvYmFsIGFuZ3VsYXIgKi9cblxuKGZ1bmN0aW9uIChhbmd1bGFyKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnY3JtLXRhc2tzLXdvcmtmbG93cycsIFtcbiAgICAnY3JtLXRhc2tzLXdvcmtmbG93cy5jb3JlJyxcbiAgICAnY3JtLXRhc2tzLXdvcmtmbG93cy5jb25zdGFudHMnLFxuICAgICdjcm0tdGFza3Mtd29ya2Zsb3dzLmNvbnRyb2xsZXJzJyxcbiAgICAnY3JtLXRhc2tzLXdvcmtmbG93cy5kZWNvcmF0b3JzJ1xuICBdKTtcbn0pKGFuZ3VsYXIpO1xuIl19
