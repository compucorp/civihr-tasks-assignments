!function(t,e){"use strict";t.module("crm-tasks-workflows.constants",[]).constant("customFieldIds",e.vars.customFieldIds)}(angular,CRM),function(t){"use strict";angular.module("crm-tasks-workflows.controllers",[])}(),function(t){"use strict";angular.module("crm-tasks-workflows.core",["crmCaseType"])}(),function(t){"use strict";angular.module("crm-tasks-workflows.decorators",[])}(),function(t){"use strict";function e(t,e,o,s,a,r,c,i){e.debug("Controller: CaseTypeExtendedController");var n,l,u,d,p,m={};function f(t,e){m.addActivity(t,e),t.activityTypes.forEach(function(t){t.name===e&&delete t.reference_activity})}a.actTypes={values:(n=r.values.map(function(t){return t.label=t.label+" (Task)",t}),l=c.values.map(function(t){return t.label=t.label+" (Document)",t}),n.concat(l))},t("CaseTypeCtrl",{$scope:o,crmApi:s,apiCalls:a}),m.addActivity=o.addActivity,o.addActivity=f,o.defaultRelationshipTypeOptions=(u=a.relTypes.values.filter(function(t){return"1"===t.is_active}),d=[],u.forEach(function(t){var e=t.label_a_b===t.label_b_a;d.push({label:t.label_b_a,value:t.id+"_b_a"}),e||d.push({label:t.label_a_b,value:t.id+"_a_b"})}),d),!o.caseType.id&&(p="custom_"+i["caseType.category"],o.caseType[p]="Workflow",o.caseType.definition.activitySets[0].activityTypes=[])}angular.module("crm-tasks-workflows.controllers").controller("CaseTypeExtendedController",e),e.$inject=["$controller","$log","$scope","crmApi","apiCalls","activityOptionsTask","activityOptionsDocument","customFieldIds"]}(),function(t){"use strict";function e(t){var e,o;function s(e){return["crmApi",function(t){return t("OptionValue","get",{option_group_id:"activity_type",component_id:e,sequential:1,options:{sort:"name",limit:0}})}]}return e=t.routes["/caseType/:id"],o=t.routes["/caseType"],e.controller="CaseTypeExtendedController",e.resolve.activityOptionsTask=s("CiviTask"),e.resolve.activityOptionsDocument=s("CiviDocument"),o.resolve.caseTypes=["crmApi","customFieldIds",function(t,e){var o="custom_"+e["caseType.category"],s={options:{limit:0}};return s[o]="Workflow",t("CaseType","get",s)}],t}angular.module("crm-tasks-workflows.decorators").config(["$provide",function(t){t.decorator("$route",e)}]),e.$inject=["$delegate"]}(),function(t){"use strict";angular.module("crm-tasks-workflows",["crm-tasks-workflows.core","crm-tasks-workflows.constants","crm-tasks-workflows.controllers","crm-tasks-workflows.decorators"])}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNybS10YXNrcy13b3JrZmxvd3MuY29uc3RhbnRzLmpzIiwiY3JtLXRhc2tzLXdvcmtmbG93cy5jb250cm9sbGVycy5qcyIsImNybS10YXNrcy13b3JrZmxvd3MuY29yZS5qcyIsImNybS10YXNrcy13b3JrZmxvd3MuZGVjb3JhdG9yLmpzIiwiY2FzZXR5cGUuZXh0ZW5kZWQuY29udHJvbGxlci5qcyIsInJvdXRlLmRlY29yYXRvci5qcyIsImNybS10YXNrcy13b3JrZmxvd3MuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIkNSTSIsIm1vZHVsZSIsImNvbnN0YW50IiwidmFycyIsImN1c3RvbUZpZWxkSWRzIiwiQ2FzZVR5cGVFeHRlbmRlZENvbnRyb2xsZXIiLCIkY29udHJvbGxlciIsIiRsb2ciLCIkc2NvcGUiLCJjcm1BcGkiLCJhcGlDYWxscyIsImFjdGl2aXR5T3B0aW9uc1Rhc2siLCJhY3Rpdml0eU9wdGlvbnNEb2N1bWVudCIsImRlYnVnIiwidGFza09wdGlvbnMiLCJkb2N1bWVudE9wdGlvbnMiLCJhY3RpdmVSZWxhdGlvbnNoaXBUeXBlcyIsImRlZmF1bHRSZWxhdGlvbnNoaXBUeXBlT3B0aW9ucyIsImNhdGVnb3J5RmllbGRuYW1lIiwicGFyZW50TWV0aG9kcyIsImFkZEFjdGl2aXR5IiwiYWN0aXZpdHlTZXQiLCJhY3Rpdml0eVR5cGUiLCJhY3Rpdml0eVR5cGVzIiwiZm9yRWFjaCIsImFjdGl2aXR5IiwibmFtZSIsInJlZmVyZW5jZV9hY3Rpdml0eSIsImFjdFR5cGVzIiwidmFsdWVzIiwibWFwIiwidHlwZSIsImxhYmVsIiwiZG9jdW1lbnQiLCJjb25jYXQiLCJyZWxUeXBlcyIsImZpbHRlciIsInJlbGF0aW9uc2hpcFR5cGUiLCJpc19hY3RpdmUiLCJpc0JpZGlyZWN0aW9uYWxSZWxhdGlvbnNoaXAiLCJsYWJlbF9hX2IiLCJsYWJlbF9iX2EiLCJwdXNoIiwidmFsdWUiLCJpZCIsImNhc2VUeXBlIiwiZGVmaW5pdGlvbiIsImFjdGl2aXR5U2V0cyIsImNvbnRyb2xsZXIiLCIkaW5qZWN0IiwiUm91dGVEZWNvcmF0b3IiLCIkZGVsZWdhdGUiLCJjYXNlVHlwZUVkaXRSb3V0ZSIsImNhc2VUeXBlTGlzdFJvdXRlIiwiZ2V0UmVzb2x2ZXJGb3JBY3Rpdml0eVR5cGVDb21wb25lbnQiLCJjb21wb25lbnROYW1lIiwib3B0aW9uX2dyb3VwX2lkIiwiY29tcG9uZW50X2lkIiwic2VxdWVudGlhbCIsIm9wdGlvbnMiLCJzb3J0IiwibGltaXQiLCJyb3V0ZXMiLCJyZXNvbHZlIiwiY2FzZVR5cGVzIiwiY2FzZVR5cGVDYXRlZ29yeUZpZWxkIiwiZmlsdGVycyIsImNvbmZpZyIsIiRwcm92aWRlIiwiZGVjb3JhdG9yIl0sIm1hcHBpbmdzIjoiQ0FFQSxTQUFBQSxFQUFBQyxHQUNBLGFBRUFELEVBQUFFLE9BQUEsZ0NBQUEsSUFDQUMsU0FBQSxpQkFBQUYsRUFBQUcsS0FBQUMsZ0JBSkEsQ0FLQUwsUUFBQUMsS0NMQSxTQUFBRCxHQUNBLGFBR0FBLFFBREFFLE9BQUEsa0NBQUEsSUFIQSxHQ0FBLFNBQUFGLEdBQ0EsYUFLQUEsUUFIQUUsT0FBQSwyQkFBQSxDQUNBLGdCQUpBLEdDQUEsU0FBQUYsR0FDQSxhQUdBQSxRQURBRSxPQUFBLGlDQUFBLElBSEEsR0NBQSxTQUFBRixHQUNBLGFBVUEsU0FBQU0sRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFDQVIsR0FDQUcsRUFBQU0sTUFBQSwwQ0FFQSxJQWtHQUMsRUFNQUMsRUFyREFDLEVBQ0FDLEVBaUVBQyxFQXJIQUMsRUFBQSxHQXdCQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUNBSCxFQUFBQyxZQUFBQyxFQUFBQyxHQUdBRCxFQUFBRSxjQUFBQyxRQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLE9BQUFKLFVBQ0FHLEVBQUFFLHFCQTBEQWpCLEVBQUFrQixTQUFBLENBQUFDLFFBVUFmLEVBQUFILEVBQUFrQixPQUFBQyxJQUFBLFNBQUFDLEdBR0EsT0FGQUEsRUFBQUMsTUFBQUQsRUFBQUMsTUFBQSxVQUVBRCxJQUdBaEIsRUFBQUgsRUFBQWlCLE9BQUFDLElBQUEsU0FBQUcsR0FHQSxPQUZBQSxFQUFBRCxNQUFBQyxFQUFBRCxNQUFBLGNBRUFDLElBR0FuQixFQUFBb0IsT0FBQW5CLEtBckJBVCxFQUFBLGVBQUEsQ0FBQUUsT0FBQUEsRUFBQUMsT0FBQUEsRUFBQUMsU0FBQUEsSUFsRkFTLEVBQUFDLFlBQUFaLEVBQUFZLFlBQ0FaLEVBQUFZLFlBQUFBLEVBQ0FaLEVBQUFTLGdDQTBDQUQsRUE0QkFOLEVBQUF5QixTQUFBTixPQUFBTyxPQUFBLFNBQUFDLEdBQ0EsTUFBQSxNQUFBQSxFQUFBQyxZQTVCQXJCLEVBQUEsR0FFQUQsRUFBQVEsUUFBQSxTQUFBYSxHQUNBLElBQUFFLEVBQUFGLEVBQUFHLFlBQUFILEVBQUFJLFVBRUF4QixFQUFBeUIsS0FBQSxDQUNBVixNQUFBSyxFQUFBSSxVQUNBRSxNQUFBTixFQUFBTyxHQUFBLFNBR0FMLEdBQ0F0QixFQUFBeUIsS0FBQSxDQUNBVixNQUFBSyxFQUFBRyxVQUNBRyxNQUFBTixFQUFBTyxHQUFBLFdBS0EzQixJQTVEQVQsRUFBQXFDLFNBQUFELEtBMkdBMUIsRUFBQSxVQUFBZCxFQUFBLHFCQUdBSSxFQUFBcUMsU0FBQTNCLEdBRkEsV0EvRUFWLEVBQUFxQyxTQUFBQyxXQUFBQyxhQUFBLEdBQUF4QixjQUFBLElBb0ZBeEIsUUF2SUFFLE9BQUEsbUNBQ0ErQyxXQUFBLDZCQUFBM0MsR0FFQUEsRUFBQTRDLFFBQUEsQ0FDQSxjQUFBLE9BQUEsU0FBQSxTQUFBLFdBQUEsc0JBQUEsMEJBQ0Esa0JBUkEsR0NBQSxTQUFBbEQsR0FDQSxhQVNBLFNBQUFtRCxFQUFBQyxHQUNBLElBQ0FDLEVBQ0FDLEVBZUEsU0FBQUMsRUFBQUMsR0FDQSxNQUFBLENBQUEsU0FBQSxTQUFBOUMsR0FDQSxPQUFBQSxFQUFBLGNBQUEsTUFBQSxDQUNBK0MsZ0JBQUEsZ0JBQ0FDLGFBQUFGLEVBQ0FHLFdBQUEsRUFDQUMsUUFBQSxDQUFBQyxLQUFBLE9BQUFDLE1BQUEsT0F1QkEsT0E3Q0FULEVBQUFELEVBQUFXLE9BQUEsaUJBQ0FULEVBQUFGLEVBQUFXLE9BQUEsYUFFQVYsRUFBQUosV0FBQSw2QkFDQUksRUFBQVcsUUFBQXBELG9CQUFBMkMsRUFBQSxZQUNBRixFQUFBVyxRQUFBbkQsd0JBQUEwQyxFQUFBLGdCQUVBRCxFQUFBVSxRQUFBQyxVQTZCQSxDQUFBLFNBQUEsaUJBQUEsU0FBQXZELEVBQUFMLEdBQ0EsSUFBQTZELEVBQUEsVUFBQTdELEVBQUEscUJBQ0E4RCxFQUFBLENBQUFQLFFBQUEsQ0FBQUUsTUFBQSxJQUdBLE9BRkFLLEVBQUFELEdBQUEsV0FFQXhELEVBQUEsV0FBQSxNQUFBeUQsS0FJQWYsRUFFQXBELFFBeERBRSxPQUFBLGtDQUNBa0UsT0FBQSxDQUFBLFdBQUEsU0FBQUMsR0FDQUEsRUFBQUMsVUFBQSxTQUFBbkIsTUFHQUEsRUFBQUQsUUFBQSxDQUFBLGFBUkEsR0NBQSxTQUFBbEQsR0FDQSxhQVFBQSxRQU5BRSxPQUFBLHNCQUFBLENBQ0EsMkJBQ0EsZ0NBQ0Esa0NBQ0EsbUNBUEEiLCJmaWxlIjoiY3JtLXRhc2tzLXdvcmtmbG93cy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgYW5ndWxhciAqL1xuXG4oZnVuY3Rpb24gKGFuZ3VsYXIsIENSTSkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2NybS10YXNrcy13b3JrZmxvd3MuY29uc3RhbnRzJywgW10pXG4gICAgLmNvbnN0YW50KCdjdXN0b21GaWVsZElkcycsIENSTS52YXJzLmN1c3RvbUZpZWxkSWRzKTtcbn0pKGFuZ3VsYXIsIENSTSk7XG4iLCIvKiBnbG9iYWwgYW5ndWxhciAqL1xuXG4oZnVuY3Rpb24gKGFuZ3VsYXIpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdjcm0tdGFza3Mtd29ya2Zsb3dzLmNvbnRyb2xsZXJzJywgW10pO1xufSkoYW5ndWxhcik7XG4iLCIvKiBnbG9iYWwgYW5ndWxhciAqL1xuXG4oZnVuY3Rpb24gKGFuZ3VsYXIpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdjcm0tdGFza3Mtd29ya2Zsb3dzLmNvcmUnLCBbXG4gICAgJ2NybUNhc2VUeXBlJ1xuICBdKTtcbn0pKGFuZ3VsYXIpO1xuIiwiLyogZ2xvYmFsIGFuZ3VsYXIgKi9cblxuKGZ1bmN0aW9uIChhbmd1bGFyKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnY3JtLXRhc2tzLXdvcmtmbG93cy5kZWNvcmF0b3JzJywgW10pO1xufSkoYW5ndWxhcik7XG4iLCIvKiBnbG9iYWwgYW5ndWxhciAqL1xuXG4oZnVuY3Rpb24gKGFuZ3VsYXIpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGFuZ3VsYXIubW9kdWxlKCdjcm0tdGFza3Mtd29ya2Zsb3dzLmNvbnRyb2xsZXJzJylcbiAgICAuY29udHJvbGxlcignQ2FzZVR5cGVFeHRlbmRlZENvbnRyb2xsZXInLCBDYXNlVHlwZUV4dGVuZGVkQ29udHJvbGxlcik7XG5cbiAgQ2FzZVR5cGVFeHRlbmRlZENvbnRyb2xsZXIuJGluamVjdCA9IFtcbiAgICAnJGNvbnRyb2xsZXInLCAnJGxvZycsICckc2NvcGUnLCAnY3JtQXBpJywgJ2FwaUNhbGxzJywgJ2FjdGl2aXR5T3B0aW9uc1Rhc2snLCAnYWN0aXZpdHlPcHRpb25zRG9jdW1lbnQnLFxuICAgICdjdXN0b21GaWVsZElkcydcbiAgXTtcblxuICBmdW5jdGlvbiBDYXNlVHlwZUV4dGVuZGVkQ29udHJvbGxlciAoJGNvbnRyb2xsZXIsICRsb2csICRzY29wZSwgY3JtQXBpLCBhcGlDYWxscywgYWN0aXZpdHlPcHRpb25zVGFzaywgYWN0aXZpdHlPcHRpb25zRG9jdW1lbnQsXG4gICAgY3VzdG9tRmllbGRJZHMpIHtcbiAgICAkbG9nLmRlYnVnKCdDb250cm9sbGVyOiBDYXNlVHlwZUV4dGVuZGVkQ29udHJvbGxlcicpO1xuXG4gICAgdmFyIHBhcmVudE1ldGhvZHMgPSB7fTtcblxuICAgIChmdW5jdGlvbiBpbml0ICgpIHtcbiAgICAgIHZhciBpc05ld0Nhc2VUeXBlO1xuXG4gICAgICBpbml0UGFyZW50Q29udHJvbGxlcigpO1xuXG4gICAgICBwYXJlbnRNZXRob2RzLmFkZEFjdGl2aXR5ID0gJHNjb3BlLmFkZEFjdGl2aXR5O1xuICAgICAgJHNjb3BlLmFkZEFjdGl2aXR5ID0gYWRkQWN0aXZpdHk7XG4gICAgICAkc2NvcGUuZGVmYXVsdFJlbGF0aW9uc2hpcFR5cGVPcHRpb25zID0gZ2V0RGVmYXVsdFJlbGF0aW9uc2hpcFR5cGVPcHRpb25zKCk7XG4gICAgICBpc05ld0Nhc2VUeXBlID0gISRzY29wZS5jYXNlVHlwZS5pZDtcblxuICAgICAgaWYgKGlzTmV3Q2FzZVR5cGUpIHtcbiAgICAgICAgc2V0Q2FzZVR5cGVEZWZhdWx0Q2F0ZWdvcnkoKTtcbiAgICAgICAgY2xlYXJBbGxBY3Rpdml0eVR5cGVzRnJvbU1haW5BY3Rpdml0eVNldCgpO1xuICAgICAgfVxuICAgIH0pKCk7XG5cbiAgICAvKipcbiAgICAgKiBBZGQgbmV3IGFjdGl2aXR5XG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhY3Rpdml0eVNldFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBhY3Rpdml0eVR5cGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhZGRBY3Rpdml0eSAoYWN0aXZpdHlTZXQsIGFjdGl2aXR5VHlwZSkge1xuICAgICAgcGFyZW50TWV0aG9kcy5hZGRBY3Rpdml0eShhY3Rpdml0eVNldCwgYWN0aXZpdHlUeXBlKTtcblxuICAgICAgLy8gcmVtb3ZlIHJlZmVyZW5jZV9hY3Rpdml0eSBwcm9wZXJ0eSBmcm9tIG5ld2x5IGFkZGVkIGFjdGl2aXR5XG4gICAgICBhY3Rpdml0eVNldC5hY3Rpdml0eVR5cGVzLmZvckVhY2goZnVuY3Rpb24gKGFjdGl2aXR5KSB7XG4gICAgICAgIGlmIChhY3Rpdml0eS5uYW1lID09PSBhY3Rpdml0eVR5cGUpIHtcbiAgICAgICAgICBkZWxldGUgYWN0aXZpdHkucmVmZXJlbmNlX2FjdGl2aXR5O1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhcnMgYWxsIHRoZSBhY3Rpdml0eSB0eXBlcyBkZWZpbmVkIGluIHRoZSBtYWluIGFjdGl2aXR5IHNldC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbGVhckFsbEFjdGl2aXR5VHlwZXNGcm9tTWFpbkFjdGl2aXR5U2V0ICgpIHtcbiAgICAgICRzY29wZS5jYXNlVHlwZS5kZWZpbml0aW9uLmFjdGl2aXR5U2V0c1swXS5hY3Rpdml0eVR5cGVzID0gW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgZGVmYXVsdCByZWxhdGlvbnNoaXAgdHlwZSBvcHRpb25zLiBJZiB0aGUgcmVsYXRpb25zaGlwIGlzXG4gICAgICogYmlkaXJlY3Rpb25hbCAoRXg6IFNwb3VzZSBvZikgaXQgYWRkcyBhIHNpbmdsZSBvcHRpb24gb3RoZXJ3aXNlIGl0IGFkZHNcbiAgICAgKiB0d28gb3B0aW9ucyByZXByZXNlbnRpbmcgdGhlIHJlbGF0aW9uc2hpcCB0eXBlIGRpcmVjdGlvbnNcbiAgICAgKiAoRXg6IEVtcGxveWVlIG9mLCBFbXBsb3llciBpcylcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge0FycmF5fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldERlZmF1bHRSZWxhdGlvbnNoaXBUeXBlT3B0aW9ucyAoKSB7XG4gICAgICB2YXIgYWN0aXZlUmVsYXRpb25zaGlwVHlwZXMgPSBnZXRBY3RpdmVSZWxhdGlvbnNoaXBUeXBlcygpO1xuICAgICAgdmFyIGRlZmF1bHRSZWxhdGlvbnNoaXBUeXBlT3B0aW9ucyA9IFtdO1xuXG4gICAgICBhY3RpdmVSZWxhdGlvbnNoaXBUeXBlcy5mb3JFYWNoKGZ1bmN0aW9uIChyZWxhdGlvbnNoaXBUeXBlKSB7XG4gICAgICAgIHZhciBpc0JpZGlyZWN0aW9uYWxSZWxhdGlvbnNoaXAgPSByZWxhdGlvbnNoaXBUeXBlLmxhYmVsX2FfYiA9PT0gcmVsYXRpb25zaGlwVHlwZS5sYWJlbF9iX2E7XG5cbiAgICAgICAgZGVmYXVsdFJlbGF0aW9uc2hpcFR5cGVPcHRpb25zLnB1c2goe1xuICAgICAgICAgIGxhYmVsOiByZWxhdGlvbnNoaXBUeXBlLmxhYmVsX2JfYSxcbiAgICAgICAgICB2YWx1ZTogcmVsYXRpb25zaGlwVHlwZS5pZCArICdfYl9hJ1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIWlzQmlkaXJlY3Rpb25hbFJlbGF0aW9uc2hpcCkge1xuICAgICAgICAgIGRlZmF1bHRSZWxhdGlvbnNoaXBUeXBlT3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgIGxhYmVsOiByZWxhdGlvbnNoaXBUeXBlLmxhYmVsX2FfYixcbiAgICAgICAgICAgIHZhbHVlOiByZWxhdGlvbnNoaXBUeXBlLmlkICsgJ19hX2InXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gZGVmYXVsdFJlbGF0aW9uc2hpcFR5cGVPcHRpb25zO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBsaXN0IG9mIGFjdGl2ZSByZWxhdGlvbnNoaXAgdHlwZXMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHtBcnJheX1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRBY3RpdmVSZWxhdGlvbnNoaXBUeXBlcyAoKSB7XG4gICAgICByZXR1cm4gYXBpQ2FsbHMucmVsVHlwZXMudmFsdWVzLmZpbHRlcihmdW5jdGlvbiAocmVsYXRpb25zaGlwVHlwZSkge1xuICAgICAgICByZXR1cm4gcmVsYXRpb25zaGlwVHlwZS5pc19hY3RpdmUgPT09ICcxJztcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpc2UgdGhlIHBhcmVudCBjb250cm9sbGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5pdFBhcmVudENvbnRyb2xsZXIgKCkge1xuICAgICAgYXBpQ2FsbHMuYWN0VHlwZXMgPSB7IHZhbHVlczogcHJlcGFyZUFjdGl2aXR5VHlwZXMoKSB9O1xuICAgICAgJGNvbnRyb2xsZXIoJ0Nhc2VUeXBlQ3RybCcsIHskc2NvcGU6ICRzY29wZSwgY3JtQXBpOiBjcm1BcGksIGFwaUNhbGxzOiBhcGlDYWxsc30pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBsaXN0IG9mIGFjdGl2aXR5IHR5cGVzIHdpdGggY29tcG9uZW50IHR5cGUgYWRkZWQgdG8gbGFiZWxcbiAgICAgKlxuICAgICAqIEByZXR1cm4ge0FycmF5fVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHByZXBhcmVBY3Rpdml0eVR5cGVzICgpIHtcbiAgICAgIHZhciB0YXNrT3B0aW9ucyA9IGFjdGl2aXR5T3B0aW9uc1Rhc2sudmFsdWVzLm1hcChmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICB0eXBlLmxhYmVsID0gKHR5cGUubGFiZWwgKyAnIChUYXNrKScpO1xuXG4gICAgICAgIHJldHVybiB0eXBlO1xuICAgICAgfSk7XG5cbiAgICAgIHZhciBkb2N1bWVudE9wdGlvbnMgPSBhY3Rpdml0eU9wdGlvbnNEb2N1bWVudC52YWx1ZXMubWFwKGZ1bmN0aW9uIChkb2N1bWVudCkge1xuICAgICAgICBkb2N1bWVudC5sYWJlbCA9IChkb2N1bWVudC5sYWJlbCArICcgKERvY3VtZW50KScpO1xuXG4gICAgICAgIHJldHVybiBkb2N1bWVudDtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gdGFza09wdGlvbnMuY29uY2F0KGRvY3VtZW50T3B0aW9ucyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyBXb3JrZmxvdyBhcyB0aGUgZGVmYXVsdCBjYXRlZ29yeSBmb3IgdGhlIGNhc2UgdHlwZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzZXRDYXNlVHlwZURlZmF1bHRDYXRlZ29yeSAoKSB7XG4gICAgICB2YXIgY2F0ZWdvcnlGaWVsZG5hbWUgPSAnY3VzdG9tXycgKyBjdXN0b21GaWVsZElkc1snY2FzZVR5cGUuY2F0ZWdvcnknXTtcbiAgICAgIHZhciBkZWZhdWx0Q2FzZVR5cGVDYXRlZ29yeSA9ICdXb3JrZmxvdyc7XG5cbiAgICAgICRzY29wZS5jYXNlVHlwZVtjYXRlZ29yeUZpZWxkbmFtZV0gPSBkZWZhdWx0Q2FzZVR5cGVDYXRlZ29yeTtcbiAgICB9XG4gIH1cbn0pKGFuZ3VsYXIpO1xuIiwiLyogZ2xvYmFsIGFuZ3VsYXIgKi9cblxuKGZ1bmN0aW9uIChhbmd1bGFyKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBhbmd1bGFyLm1vZHVsZSgnY3JtLXRhc2tzLXdvcmtmbG93cy5kZWNvcmF0b3JzJylcbiAgICAuY29uZmlnKFsnJHByb3ZpZGUnLCBmdW5jdGlvbiAoJHByb3ZpZGUpIHtcbiAgICAgICRwcm92aWRlLmRlY29yYXRvcignJHJvdXRlJywgUm91dGVEZWNvcmF0b3IpO1xuICAgIH1dKTtcblxuICBSb3V0ZURlY29yYXRvci4kaW5qZWN0ID0gWyckZGVsZWdhdGUnXTtcblxuICBmdW5jdGlvbiBSb3V0ZURlY29yYXRvciAoJGRlbGVnYXRlKSB7XG4gICAgKGZ1bmN0aW9uIGluaXQgKCkge1xuICAgICAgdmFyIGNhc2VUeXBlRWRpdFJvdXRlID0gJGRlbGVnYXRlLnJvdXRlc1snL2Nhc2VUeXBlLzppZCddO1xuICAgICAgdmFyIGNhc2VUeXBlTGlzdFJvdXRlID0gJGRlbGVnYXRlLnJvdXRlc1snL2Nhc2VUeXBlJ107XG5cbiAgICAgIGNhc2VUeXBlRWRpdFJvdXRlLmNvbnRyb2xsZXIgPSAnQ2FzZVR5cGVFeHRlbmRlZENvbnRyb2xsZXInO1xuICAgICAgY2FzZVR5cGVFZGl0Um91dGUucmVzb2x2ZS5hY3Rpdml0eU9wdGlvbnNUYXNrID0gZ2V0UmVzb2x2ZXJGb3JBY3Rpdml0eVR5cGVDb21wb25lbnQoJ0NpdmlUYXNrJyk7XG4gICAgICBjYXNlVHlwZUVkaXRSb3V0ZS5yZXNvbHZlLmFjdGl2aXR5T3B0aW9uc0RvY3VtZW50ID0gZ2V0UmVzb2x2ZXJGb3JBY3Rpdml0eVR5cGVDb21wb25lbnQoJ0NpdmlEb2N1bWVudCcpO1xuXG4gICAgICBjYXNlVHlwZUxpc3RSb3V0ZS5yZXNvbHZlLmNhc2VUeXBlcyA9IGdldFJlc29sdmVyRm9yV29ya2Zsb3dUeXBlcygpO1xuICAgIH0pKCk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcmVzb2x2ZXIgZm9yIHRoZSBsaXN0IG9mIGFjdGl2aXR5IHR5cGVzIGZvciBhIHBhcnRpY3VsYXIgY29tcG9uZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtICB7U3RyaW5nfSBjb21wb25lbnROYW1lIC0gdGhlIG5hbWUgb2YgdGhlIGFjdGl2aXR5IHR5cGUncyBjb21wb25lbnQuXG4gICAgICogQHJldHVybiB7QXJyYXl9ICBBbiBhcnJheSBjb250YWluaW5nIHRoZSBmdW5jdGlvbiB0aGF0IHdpbGwgcmVzb2x2ZSB0aGUgYWN0aXZpdHkgdHlwZXMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UmVzb2x2ZXJGb3JBY3Rpdml0eVR5cGVDb21wb25lbnQgKGNvbXBvbmVudE5hbWUpIHtcbiAgICAgIHJldHVybiBbJ2NybUFwaScsIGZ1bmN0aW9uIGFjdGl2aXR5T3B0aW9uc1Jlc29sdmVyIChjcm1BcGkpIHtcbiAgICAgICAgcmV0dXJuIGNybUFwaSgnT3B0aW9uVmFsdWUnLCAnZ2V0Jywge1xuICAgICAgICAgIG9wdGlvbl9ncm91cF9pZDogJ2FjdGl2aXR5X3R5cGUnLFxuICAgICAgICAgIGNvbXBvbmVudF9pZDogY29tcG9uZW50TmFtZSxcbiAgICAgICAgICBzZXF1ZW50aWFsOiAxLFxuICAgICAgICAgIG9wdGlvbnM6IHsgc29ydDogJ25hbWUnLCBsaW1pdDogMCB9XG4gICAgICAgIH0pO1xuICAgICAgfV07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHJlc29sdmVyIGZvciB0aGUgbGlzdCBvZiB3b3JrZmxvdyBjYXNlIHR5cGVzLlxuICAgICAqIFRvIGZpbHRlciBieSBjYXRlZ29yeSB3ZSBuZWVkIHRvIHVzZSB0aGUgY3VzdG9tIGNhdGVnb3J5IGZpZWxkIGlkIGFzXG4gICAgICogcHJvdmlkZWQgYnkgdGhlIENSTSB2YXJzLiBUaGUgY2F0ZWdvcnkgZmllbGQgY2FuIGJlIHJlZmVyZW5jZWQgYnkgdXNpbmdcbiAgICAgKiBgY3VzdG9tXzEyM2Agd2hlcmUgYDEyM2AgaXMgdGhlIGlkIG9mIHRoZSBjYXRlZ29yeSBmaWVsZC5cbiAgICAgKlxuICAgICAqIEByZXR1cm4ge0FycmF5fSBBbiBhcnJheSBjb250YWluaW5nIHRoZSBmdW5jdGlvbiB0aGF0IHdpbGwgcmVzb2x2ZSB0aGUgd29ya2Zsb3cgY2FzZSB0eXBlcy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRSZXNvbHZlckZvcldvcmtmbG93VHlwZXMgKCkge1xuICAgICAgcmV0dXJuIFsnY3JtQXBpJywgJ2N1c3RvbUZpZWxkSWRzJywgZnVuY3Rpb24gd29ya2Zsb3dUeXBlc1Jlc29sdmVyIChjcm1BcGksIGN1c3RvbUZpZWxkSWRzKSB7XG4gICAgICAgIHZhciBjYXNlVHlwZUNhdGVnb3J5RmllbGQgPSAnY3VzdG9tXycgKyBjdXN0b21GaWVsZElkc1snY2FzZVR5cGUuY2F0ZWdvcnknXTtcbiAgICAgICAgdmFyIGZpbHRlcnMgPSB7IG9wdGlvbnM6IHsgbGltaXQ6IDAgfSB9O1xuICAgICAgICBmaWx0ZXJzWyBjYXNlVHlwZUNhdGVnb3J5RmllbGQgXSA9ICdXb3JrZmxvdyc7XG5cbiAgICAgICAgcmV0dXJuIGNybUFwaSgnQ2FzZVR5cGUnLCAnZ2V0JywgZmlsdGVycyk7XG4gICAgICB9XTtcbiAgICB9XG5cbiAgICByZXR1cm4gJGRlbGVnYXRlO1xuICB9XG59KShhbmd1bGFyKTtcbiIsIi8qIGdsb2JhbCBhbmd1bGFyICovXG5cbihmdW5jdGlvbiAoYW5ndWxhcikge1xuICAndXNlIHN0cmljdCc7XG5cbiAgYW5ndWxhci5tb2R1bGUoJ2NybS10YXNrcy13b3JrZmxvd3MnLCBbXG4gICAgJ2NybS10YXNrcy13b3JrZmxvd3MuY29yZScsXG4gICAgJ2NybS10YXNrcy13b3JrZmxvd3MuY29uc3RhbnRzJyxcbiAgICAnY3JtLXRhc2tzLXdvcmtmbG93cy5jb250cm9sbGVycycsXG4gICAgJ2NybS10YXNrcy13b3JrZmxvd3MuZGVjb3JhdG9ycydcbiAgXSk7XG59KShhbmd1bGFyKTtcbiJdfQ==
