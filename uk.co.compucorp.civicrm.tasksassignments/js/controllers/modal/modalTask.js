define(['controllers/controllers',        'services/task'], function(controllers){    controllers.controller('ModalTaskCtrl',['$scope', '$modalInstance', '$log', 'Task', 'data', 'settings',        function($scope, $modalInstance, $log, Task, data, settings){            $log.debug('Controller: ModalTaskCtrl');            $scope.task = {}            angular.copy(data,$scope.task);            $scope.task.target_contact_id = $scope.task.target_contact_id || settings.contactId;            $scope.dpOpen = function($event){                $event.preventDefault();                $event.stopPropagation();                $scope.dpOpened = true;            }            $scope.cancel = function(){                $modalInstance.dismiss('cancel');            }            $scope.confirm = function(){                console.log($scope.task);                console.log(angular.equals($scope.task,data));                var task = new Task();                task.$save({                    action: 'create',                    json: angular.extend({                        sequential: 1                    },$scope.task)                },function(data){                    $modalInstance.close(angular.extend(data.values[0],$scope.task));                });            }        }]);});